const t=new class{constructor(t){this.score=0,this.state="idle",this.startButtonHasBeenClicked=!1,this.button=document.querySelector(".start"),this.gameActive=!1,this.board=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.handleKeyDown=this.handleKeyDown.bind(this)}getState(){return this.board}updateDOMFromBoard(){for(let t=0;t<4;t++)for(let e=0;e<4;e++){let s=this.board[t][e],r=document.querySelector(`.field-row:nth-child(${t+1}) .field-cell:nth-child(${e+1})`);r&&(r.textContent=s?s.toString():"",r.className=`field-cell field-cell--${s||""}`)}this.board.flat().includes(2048)&&this.updateState("win")}updateState(t){this.state=t}addScore(t){this.score+=t;let e=document.querySelector(".game-score");e&&(e.textContent=this.score)}getScore(){return this.score}initializeGame(){this.score=0,this.addScore(0),this.hideMessages(),document.querySelectorAll(".field-cell").forEach(t=>{t.textContent="",t.className="field-cell"}),this.spawnRandomNumber(),this.spawnRandomNumber(),this.updateDOMFromBoard()}start(){this.updateState("playing"),this.initializeGame(),this.startButtonHasBeenClicked=!0,this.button&&(this.button.textContent="Restart",this.button.classList.remove("start"),this.button.classList.add("restart"))}restart(){this.updateState("idle"),this.gameActive=!1,this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.addScore(0),this.hideMessages(),this.updateDOMFromBoard(),this.button&&(this.button.classList.remove("restart"),this.button.classList.add("start"),this.button.textContent="Start")}getStatus(){return this.state}moveLeft(){if("playing"!==this.state)return!1;let t=!1;for(let e=0;e<4;e++){let s=[!1,!1,!1,!1];for(let r=1;r<4;r++)if(0!==this.board[e][r]){let i=r;for(;i>0;)if(0===this.board[e][i-1])this.board[e][i-1]=this.board[e][i],this.board[e][i]=0,i--,t=!0;else if(this.board[e][i-1]!==this.board[e][i]||s[i-1])break;else{this.board[e][i-1]*=2,this.board[e][i]=0,s[i-1]=!0,this.addScore(this.board[e][i-1]),t=!0;break}}}return t&&this.spawnRandomNumber(),this.checkLoseCondition(),this.updateDOMFromBoard(),t}moveRight(){if("playing"!==this.state)return!1;let t=!1;for(let e=0;e<4;e++){let s=[!1,!1,!1,!1];for(let r=2;r>=0;r--)if(0!==this.board[e][r]){let i=r;for(;i<3;)if(0===this.board[e][i+1])this.board[e][i+1]=this.board[e][i],this.board[e][i]=0,i++,t=!0;else if(this.board[e][i+1]!==this.board[e][i]||s[i+1])break;else{this.board[e][i+1]*=2,this.board[e][i]=0,s[i+1]=!0,this.addScore(this.board[e][i+1]),t=!0;break}}}return t&&this.spawnRandomNumber(),this.checkLoseCondition(),this.updateDOMFromBoard(),t}moveUp(){if("playing"!==this.state)return!1;let t=!1;for(let e=0;e<4;e++){let s=[!1,!1,!1,!1];for(let r=1;r<4;r++)if(0!==this.board[r][e]){let i=r;for(;i>0;)if(0===this.board[i-1][e])this.board[i-1][e]=this.board[i][e],this.board[i][e]=0,i--,t=!0;else if(this.board[i-1][e]!==this.board[i][e]||s[i-1])break;else{this.board[i-1][e]*=2,this.board[i][e]=0,s[i-1]=!0,this.addScore(this.board[i-1][e]),t=!0;break}}}return t&&this.spawnRandomNumber(),this.checkLoseCondition(),this.updateDOMFromBoard(),t}moveDown(){if("playing"!==this.state)return!1;let t=!1;for(let e=0;e<4;e++){let s=[!1,!1,!1,!1];for(let r=2;r>=0;r--)if(0!==this.board[r][e]){let i=r;for(;i<3;)if(0===this.board[i+1][e])this.board[i+1][e]=this.board[i][e],this.board[i][e]=0,i++,t=!0;else if(this.board[i+1][e]!==this.board[i][e]||s[i+1])break;else{this.board[i+1][e]*=2,this.board[i][e]=0,s[i+1]=!0,this.addScore(this.board[i+1][e]),t=!0;break}}}return t&&this.spawnRandomNumber(),this.checkLoseCondition(),this.updateDOMFromBoard(),t}handleKeyDown(t){if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.key))switch(t.key){case"ArrowUp":this.moveUp();break;case"ArrowDown":this.moveDown();break;case"ArrowLeft":this.moveLeft();break;case"ArrowRight":this.moveRight()}}spawnRandomNumber(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.board[e][s]&&t.push({row:e,col:s});if(0===t.length){this.checkLoseCondition();return}let e=Math.floor(Math.random()*t.length),{row:s,col:r}=t[e];this.board[s][r]=.9>Math.random()?2:4,this.updateDOMFromBoard()}hideMessages(){let t=document.querySelector(".message-lose"),e=document.querySelector(".message-win"),s=document.querySelector(".message-start");t&&t.classList.add("hidden"),e&&e.classList.add("hidden"),s&&s.classList.add("hidden")}checkLoseCondition(){this.board.flat().some(t=>0===t)||this.checkPossibleMerges()||(this.hideMessages(),this.updateState("lose"),document.querySelector(".message-lose").classList.remove("hidden"),this.gameActive=!1)}checkPossibleMerges(t){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(e<3&&this.board[t][e]===this.board[t][e+1]||t<3&&this.board[t][e]===this.board[t+1][e])return!0;return!1}};document.querySelector(".start").addEventListener("click",()=>{!1===t.startButtonHasBeenClicked||t.restart(),t.start()}),document.addEventListener("keydown",e=>t.handleKeyDown(e));
//# sourceMappingURL=index.f6e10e06.js.map
