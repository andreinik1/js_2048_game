var t;t=new(function(){var t;function e(t){(function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")})(this,e),this.score=0,this.state="idle",this.startButtonHasBeenClicked=!1,this.button=document.querySelector(".start"),this.gameActive=!1,this.board=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.handleKeyDown=this.handleKeyDown.bind(this)}return t=[{key:"getState",value:function(){return this.board}},{key:"updateDOMFromBoard",value:function(){for(var t=0;t<4;t++)for(var e=0;e<4;e++){var r=this.board[t][e],a=document.querySelector(".field-row:nth-child(".concat(t+1,") .field-cell:nth-child(").concat(e+1,")"));a&&(a.textContent=r?r.toString():"",a.className="field-cell field-cell--".concat(r||""))}this.board.flat().includes(2048)&&this.updateState("win")}},{key:"updateState",value:function(t){this.state=t}},{key:"addScore",value:function(t){this.score+=t;var e=document.querySelector(".game-score");e&&(e.textContent=this.score)}},{key:"getScore",value:function(){return this.score}},{key:"initializeGame",value:function(){this.score=0,this.addScore(0),this.hideMessages(),document.querySelectorAll(".field-cell").forEach(function(t){t.textContent="",t.className="field-cell"}),this.spawnRandomNumber(),this.spawnRandomNumber(),this.updateDOMFromBoard()}},{key:"start",value:function(){this.updateState("playing"),this.initializeGame(),this.startButtonHasBeenClicked=!0,this.button&&(this.button.textContent="Restart",this.button.classList.remove("start"),this.button.classList.add("restart"))}},{key:"restart",value:function(){this.updateState("idle"),this.gameActive=!1,this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.addScore(0),this.hideMessages(),this.updateDOMFromBoard(),this.button&&(this.button.classList.remove("restart"),this.button.classList.add("start"),this.button.textContent="Start")}},{key:"getStatus",value:function(){return this.state}},{key:"moveLeft",value:function(){if("playing"!==this.state)return!1;for(var t=!1,e=0;e<4;e++)for(var r=[!1,!1,!1,!1],a=1;a<4;a++)if(0!==this.board[e][a])for(var o=a;o>0;)if(0===this.board[e][o-1])this.board[e][o-1]=this.board[e][o],this.board[e][o]=0,o--,t=!0;else if(this.board[e][o-1]!==this.board[e][o]||r[o-1])break;else{this.board[e][o-1]*=2,this.board[e][o]=0,r[o-1]=!0,this.addScore(this.board[e][o-1]),t=!0;break}return t&&this.spawnRandomNumber(),this.checkLoseCondition(),this.updateDOMFromBoard(),t}},{key:"moveRight",value:function(){if("playing"!==this.state)return!1;for(var t=!1,e=0;e<4;e++)for(var r=[!1,!1,!1,!1],a=2;a>=0;a--)if(0!==this.board[e][a])for(var o=a;o<3;)if(0===this.board[e][o+1])this.board[e][o+1]=this.board[e][o],this.board[e][o]=0,o++,t=!0;else if(this.board[e][o+1]!==this.board[e][o]||r[o+1])break;else{this.board[e][o+1]*=2,this.board[e][o]=0,r[o+1]=!0,this.addScore(this.board[e][o+1]),t=!0;break}return t&&this.spawnRandomNumber(),this.checkLoseCondition(),this.updateDOMFromBoard(),t}},{key:"moveUp",value:function(){if("playing"!==this.state)return!1;for(var t=!1,e=0;e<4;e++)for(var r=[!1,!1,!1,!1],a=1;a<4;a++)if(0!==this.board[a][e])for(var o=a;o>0;)if(0===this.board[o-1][e])this.board[o-1][e]=this.board[o][e],this.board[o][e]=0,o--,t=!0;else if(this.board[o-1][e]!==this.board[o][e]||r[o-1])break;else{this.board[o-1][e]*=2,this.board[o][e]=0,r[o-1]=!0,this.addScore(this.board[o-1][e]),t=!0;break}return t&&this.spawnRandomNumber(),this.checkLoseCondition(),this.updateDOMFromBoard(),t}},{key:"moveDown",value:function(){if("playing"!==this.state)return!1;for(var t=!1,e=0;e<4;e++)for(var r=[!1,!1,!1,!1],a=2;a>=0;a--)if(0!==this.board[a][e])for(var o=a;o<3;)if(0===this.board[o+1][e])this.board[o+1][e]=this.board[o][e],this.board[o][e]=0,o++,t=!0;else if(this.board[o+1][e]!==this.board[o][e]||r[o+1])break;else{this.board[o+1][e]*=2,this.board[o][e]=0,r[o+1]=!0,this.addScore(this.board[o+1][e]),t=!0;break}return t&&this.spawnRandomNumber(),this.checkLoseCondition(),this.updateDOMFromBoard(),t}},{key:"handleKeyDown",value:function(t){if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.key))switch(t.key){case"ArrowUp":this.moveUp();break;case"ArrowDown":this.moveDown();break;case"ArrowLeft":this.moveLeft();break;case"ArrowRight":this.moveRight()}}},{key:"spawnRandomNumber",value:function(){for(var t=[],e=0;e<4;e++)for(var r=0;r<4;r++)0===this.board[e][r]&&t.push({row:e,col:r});if(0===t.length){this.checkLoseCondition();return}var a=Math.floor(Math.random()*t.length),o=t[a],s=o.row,i=o.col;this.board[s][i]=.9>Math.random()?2:4,this.updateDOMFromBoard()}},{key:"hideMessages",value:function(){var t=document.querySelector(".message-lose"),e=document.querySelector(".message-win"),r=document.querySelector(".message-start");t&&t.classList.add("hidden"),e&&e.classList.add("hidden"),r&&r.classList.add("hidden")}},{key:"checkLoseCondition",value:function(){this.board.flat().some(function(t){return 0===t})||this.checkPossibleMerges()||(this.hideMessages(),this.updateState("lose"),document.querySelector(".message-lose").classList.remove("hidden"),this.gameActive=!1)}},{key:"checkPossibleMerges",value:function(t){for(var e=0;e<4;e++)for(var r=0;r<4;r++)if(r<3&&this.board[e][r]===this.board[e][r+1]||e<3&&this.board[e][r]===this.board[e+1][r])return!0;return!1}}],function(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}(e.prototype,t),e}()),document.querySelector(".start").addEventListener("click",function(){!1===t.startButtonHasBeenClicked||t.restart(),t.start()}),document.addEventListener("keydown",function(e){return t.handleKeyDown(e)});
//# sourceMappingURL=index.2ab3300a.js.map
